set -o vi
PS1="$(print '\033[0;31m[\033[1;33m${USER:=$(id -un)}''\033[0;32m@\033[0;34m${HOSTNAME:=$(hostname)}' '\033[0;35m${PWD/#"$HOME"/\~}\033[0;31m]\033[0m\n$ ' )"
HISTFILE="$HOME/.mksh_history"
HISTSIZE=100000

export EDITOR="vis"
export BROWSER="firefox"
export GPG_TTY=$(tty)
export PATH=$PATH:~/.local/bin

handle_res() {
    test -z "$1" && return
    test -d "$1" && cd "$selected_res"
    test -f "$1" && cd $(dirname "$selected_res") && vise $(basename "$selected_res")
}
ro() {
    selected_res=$(rg -l -g "!tags" "$1" | fzy -l 50)
    test -z "$selected_res" && return
    vise +/"$1" "$selected_res" 
    lo "$1"
}
nmc(){
    selected_wifi=$(nmcli device wifi list | tail -n +2 | fzy -l 50 | awk 'BEGIN{FS="   *"}{print $3}' | xargs)
    test -n "$1" && nmcli device wifi connect "$selected_wifi" password "$1"
    test -z "$1" && nmcli device wifi connect "$selected_wifi"
}
ms() { selected_song=$(mpc playlist | nl -s ". " | fzy -l 50 | awk -F '.' '{print $1}' | xargs) && mpc play "$selected_song"; }
gm() { git commit -a -m "$1" && git push; }
rp() { rg -l -g "!tags" "$1" | xargs less +/"$1"; }
cl() { readlink -f "$1" | xclip; }

alias copy_or_move_helper='selected_res=$(fd . "$HOME" | fzy -l 50) && \
    dest_dir=$(fd --type d . "$HOME" | fzy -l 50) && \
    test -z "$dest_dir" && dest_dir="./"'
alias cf='copy_or_move_helper ; \
    test -d "$selected_res" && cp -r "$selected_res" "$dest_dir" ; \
    test -f "$selected_res" && cp "$selected_res" "$dest_dir"'
alias mp='selected_dir=$(fd --type d . "$HOME/Music" | fzy -l 50) &&  \
    mpc clear && \
    mpc add "$selected_dir" && \
    mpc play'
alias mf='copy_or_move_helper ; mv "$selected_res" "$dest_dir"'
alias oi='selected_res=$(fd | fzy -l 50) ; handle_res "$selected_res"'
alias oc='selected_res=$(fd -d 1 | fzy -l 50) ; handle_res "$selected_res"'
alias oa='selected_res=$(fd . "$HOME" | fzy -l 50) ; handle_res "$selected_res"'
alias ba='echo $PWD >> ~/.marks ; cat ~/.marks | sort | uniq > ~/.marks'
alias bj='selected=$(cat ~/.marks | fzy -l 50) && cd "$selected"'
alias p='fd --type f -d 1 | xargs less'
alias c='cd'
alias v='vis'
alias n='newsraft'
alias g='gurk'
alias l='ls -a --color=auto -1 -p'
alias h='eval $(history -1000 | fzy | awk "{\$1=\"\"; print \$0}" | xargs)'
alias ml='mless'
alias xrb='xrandr --output eDP-1 --brightness'
alias gp='git add --all; git commit -a -m "auto commit"; git push'
alias gu='git pull'
alias gb="git branch"
alias gc="git checkout \$(git branch | fzy -l 30)"
alias up="sudo xbps-install -Su"
alias autor="sudo xbps-remove -o"
alias useri="sudo xbps-query -m"
alias nmr='nmcli device wifi resc'
alias pys='source /home/david/.local/pip/venvs/env1/bin/activate'
alias xi='sudo xbps-install'
alias xr='sudo xbps-remove -R'
alias xq='sudo xbps-query -Rs'
alias pm='ncpamixer'
alias cw='curl wttr.in/New+York+City'
alias mm='mlist /home/david/.local/share/mail/dkerrigan@mailbox.org/INBOX | msort -d -r | mseq -S | mscan | head -n 50 | tac'
alias mg='mlist /home/david/.local/share/mail/david19kerrigan@gmail.com/INBOX | msort -d -r | mseq -S | mscan | head -n 50 | tac'
